<?xml version="1.0" encoding="UTF-8"?>
<database name="ncanode" defaultIdMethod="native" namespace="Ncanode\Model">
    <!--  table with saved signatures  -->
    <table name="ncanode_signature" phpName="Signature">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
        <column name="document" type="varchar" size="255" required="true"/> <!-- Sign document code -->
        <column name="thread" type="varchar" size="255" required="true"/> <!-- Thread -->
        <column name="cms" type="longvarchar" required="true" /> <!-- CMS or XML sign -->
        <behavior name="timestampable"/>
        <behavior name="versionable">
            <parameter name="log_created_at" value="true" />
            <parameter name="log_created_by" value="true" />
            <parameter name="log_comment" value="true" />
        </behavior>
        <unique>
            <unique-column name="thread"/>
            <unique-column name="document"/>
        </unique>
    </table>

    <!--  table with tags  -->
    <table name="ncanode_tag" phpName="Tag">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
        <column name="code" type="varchar" size="255" required="true"/> <!-- Tag code -->
        <behavior name="timestampable"/>
        <unique>
            <unique-column name="code"/>
        </unique>
    </table>

    <!-- Table that describes which roles in which groups user has -->
    <table name="ncanode_signature_tag" isCrossRef="true" phpName="SignatureTag">
        <column name="signature_id" type="integer" primaryKey="true"/>
        <column name="tag_id" type="integer" primaryKey="true"/>
        <foreign-key foreignTable="ncanode_signature" phpName="Signature" onDelete="CASCADE" onUpdate="CASCADE">
            <reference local="signature_id" foreign="id"/>
        </foreign-key>
        <foreign-key foreignTable="ncanode_tag" phpName="Tag" onDelete="CASCADE" onUpdate="CASCADE">
            <reference local="tag_id" foreign="id"/>
        </foreign-key>
        <behavior name="timestampable"/>
    </table>
</database>